{"version":3,"file":"bundle.js","mappings":";;;;;;;;;AAAA,IAAMA,cAAc,GAAG,CACnB;EACIC,MAAM,EAAE,OAAO;EACfC,IAAI,EAAE,qBAAqB;EAC3BC,OAAO,EAAE,gBAAgB;EACzBC,SAAS,EAAE;AACf,CAAC,EACD;EACIH,MAAM,EAAE,OAAO;EACfC,IAAI,EAAE,qBAAqB;EAC3BC,OAAO,EAAE,UAAU;EACnBC,SAAS,EAAE;AACf,CAAC,EACD;EACIH,MAAM,EAAE,OAAO;EACfC,IAAI,EAAE,qBAAqB;EAC3BC,OAAO,EAAE,yDAAyD;EAClEC,SAAS,EAAE;AACf,CAAC,EACD;EACIH,MAAM,EAAE,OAAO;EACfC,IAAI,EAAE,qBAAqB;EAC3BC,OAAO,EAAE,kBAAkB;EAC3BC,SAAS,EAAE;AACf,CAAC,CACJ;AAED,SAASC,gBAAgBA,CAACJ,MAAM,EAAEE,OAAO,EAAE;EACvC,IAAMD,IAAI,GAAGI,OAAO,CAAC,CAAC;EACtB,IAAMF,SAAS,GAAGG,IAAI,CAACC,GAAG,CAAC,CAAC;EAC5BR,cAAc,CAACS,IAAI,CAAC;IAAER,MAAM,EAANA,MAAM;IAAEC,IAAI,EAAJA,IAAI;IAAEC,OAAO,EAAPA,OAAO;IAAEC,SAAS,EAATA;EAAU,CAAC,CAAC;AAC7D;AAEA,SAASM,oBAAoBA,CAACC,WAAW,EAAE;EACvC,OAAOX,cAAc,CAACY,MAAM,CAAC,UAAAC,GAAG;IAAA,OAAIA,GAAG,CAACT,SAAS,IAAIO,WAAW;EAAA,EAAC;AACrE;AAEA,SAASL,OAAOA,CAAA,EAAG;EACf,IAAMQ,IAAI,GAAG,IAAIP,IAAI,CAAC,CAAC;EACvB,IAAMQ,IAAI,GAAGD,IAAI,CAACE,WAAW,CAAC,CAAC;EAC/B,IAAMC,KAAK,GAAGC,MAAM,CAACJ,IAAI,CAACK,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EAC1D,IAAMC,GAAG,GAAGH,MAAM,CAACJ,IAAI,CAACQ,OAAO,CAAC,CAAC,CAAC,CAACF,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EACnD,IAAMG,KAAK,GAAGL,MAAM,CAACJ,IAAI,CAACU,QAAQ,CAAC,CAAC,CAAC,CAACJ,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EACtD,IAAMK,OAAO,GAAGP,MAAM,CAACJ,IAAI,CAACY,UAAU,CAAC,CAAC,CAAC,CAACN,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EAC1D,IAAMO,OAAO,GAAGT,MAAM,CAACJ,IAAI,CAACc,UAAU,CAAC,CAAC,CAAC,CAACR,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EAE1D,UAAAS,MAAA,CAAUd,IAAI,OAAAc,MAAA,CAAIZ,KAAK,OAAAY,MAAA,CAAIR,GAAG,OAAAQ,MAAA,CAAIN,KAAK,OAAAM,MAAA,CAAIJ,OAAO,OAAAI,MAAA,CAAIF,OAAO;AAEjE;AAEA,IAAMG,UAAU,GAAG;EACf,aAAa,EAAE,CACX;IACI7B,MAAM,EAAE,OAAO;IACfC,IAAI,EAAE,qBAAqB;IAC3BC,OAAO,EAAE,6BAA6B;IACtCC,SAAS,EAAE;EACf,CAAC,EACD;IACIH,MAAM,EAAE,OAAO;IACfC,IAAI,EAAE,qBAAqB;IAC3BC,OAAO,EAAE,UAAU;IACnBC,SAAS,EAAE;EACf,CAAC,CACJ;EACD,aAAa,EAAE,CACX;IACIH,MAAM,EAAE,OAAO;IACfC,IAAI,EAAE,qBAAqB;IAC3BC,OAAO,EAAE,wCAAwC;IACjDC,SAAS,EAAE;EACf,CAAC,EACD;IACIH,MAAM,EAAE,OAAO;IACfC,IAAI,EAAE,qBAAqB;IAC3BC,OAAO,EAAE,sCAAsC;IAC/CC,SAAS,EAAE;EACf,CAAC,EACD;IACIH,MAAM,EAAE,OAAO;IACfC,IAAI,EAAE,qBAAqB;IAC3BC,OAAO,EAAE,uBAAuB;IAChCC,SAAS,EAAE;EACf,CAAC;AAET,CAAC;AAED,SAAS2B,YAAYA,CAACC,QAAQ,EAAE/B,MAAM,EAAEE,OAAO,EAAE;EAC7C,IAAI,CAAC2B,UAAU,CAACE,QAAQ,CAAC,EAAE;IACvBF,UAAU,CAACE,QAAQ,CAAC,GAAG,EAAE;EAC7B;EACA,IAAM5B,SAAS,GAAGG,IAAI,CAACC,GAAG,CAAC,CAAC;EAC5B,IAAMN,IAAI,GAAGI,OAAO,CAAC,CAAC;EACtBwB,UAAU,CAACE,QAAQ,CAAC,CAACvB,IAAI,CAAC;IAAER,MAAM,EAANA,MAAM;IAAEC,IAAI,EAAJA,IAAI;IAAEC,OAAO,EAAPA,OAAO;IAAEC,SAAS,EAATA;EAAU,CAAC,CAAC;AACnE;AAEA,SAAS6B,cAAcA,CAACC,KAAK,EAAEC,KAAK,EAAE;EAClC,IAAMH,QAAQ,GAAG,CAACE,KAAK,EAAEC,KAAK,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;EAChD,OAAOL,QAAQ;AACnB;AAEA,SAASM,gBAAgBA,CAACN,QAAQ,EAAErB,WAAW,EAAE;EAC7C,IAAI,CAACmB,UAAU,CAACE,QAAQ,CAAC,EAAE;IACvB,OAAO,EAAE;EACb;EACA,OAAOF,UAAU,CAACE,QAAQ,CAAC,CAACpB,MAAM,CAAC,UAAAC,GAAG;IAAA,OAAIA,GAAG,CAACT,SAAS,GAAGO,WAAW;EAAA,EAAC;AAC1E;AAEA,IAAM4B,QAAQ,GAAG;EACbvC,cAAc,EAAdA,cAAc;EACdK,gBAAgB,EAAhBA,gBAAgB;EAChBK,oBAAoB,EAApBA,oBAAoB;EACpBoB,UAAU,EAAVA,UAAU;EACVC,YAAY,EAAZA,YAAY;EACZE,cAAc,EAAdA,cAAc;EACdK,gBAAgB,EAAhBA;AACJ,CAAC;AAEDE,MAAM,CAACC,OAAO,GAAGF,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;;ACtHoB;AAC4F;AACmC;AACzE;AACnG,IAAI2B,UAAU,GAAG,IAAI;AAEd,SAASC,gBAAgBA,CAAAC,IAAA,EAAuB;EAAA,IAApBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,SAAS,GAAAF,IAAA,CAATE,SAAS;EAC/CD,KAAK,CAACE,gBAAgB,CAAC,QAAQ,EAAE,UAACC,KAAK,EAAK;IACxCA,KAAK,CAACC,cAAc,CAAC,CAAC;IACtB,IAAI,CAACD,KAAK,CAACE,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAC,YAAY,CAAC,EAAE;MAChD;IACJ;IACA,IAAMC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,iBAAiB,CAAC,CAACC,KAAK;IAChE7B,iDAAS,CAAC,CAAC;IACXU,gDAAS,CAAC;MAAEQ,KAAK,EAALA,KAAK;MAAEC,SAAS,EAATA;IAAU,CAAC,CAAC;IAC/BzB,qDAAU,CAACgC,QAAQ,EAAEP,SAAS,CAACW,cAAc,CAAC,CACzCC,IAAI,CAAC,UAAAC,IAAI,EAAI;MACVlC,gDAAQ,CAAC,CAAC;MACVG,uDAAe,CAAC,CAAC;MACjBQ,oDAAY,CAACuB,IAAI,CAACC,QAAQ,CAAC;MAC3B1B,iDAAS,CAACyB,IAAI,CAACE,iBAAiB,CAAC;MACjC7B,gDAAQ,CAACqB,QAAQ,CAAC;MAClBlB,oDAAY,CAAC,CAAC;MACdG,iDAAU,CAAC;QAAEO,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;MAChC,OAAOvB,0DAAe,CAACuB,SAAS,CAACW,cAAc,CAAC;IACpD,CAAC,CAAC,CAACC,IAAI,CAAC,UAAAI,MAAM,EAAI;MACd5B,iDAAS,CAAC4B,MAAM,CAAC;MACjBpC,sDAAc,CAAC,CAAC;MAChBY,iDAAU,CAAC;QAAEO,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;MAChCiB,YAAY,CAAClB,KAAK,EAAEC,SAAS,CAAC;IAClC,CAAC,CAAC,SACI,CAAC,UAACkB,GAAG,EAAK;MACZjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;MACnBrC,uDAAe,CAAC,CAAC;MACjBS,gDAAS,CAAC;QAAEQ,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;MAC/B,IAAMoB,cAAc,GAAGrB,KAAK,CAACU,aAAa,CAAC,gBAAgB,CAAC;MAC5D,IAAIW,cAAc,EAAE;QAChBA,cAAc,CAACC,KAAK,CAACC,OAAO,GAAG,OAAO;MAC1C;IACJ,CAAC,CAAC;EACV,CAAC,CAAC;AAEN;AAEO,SAASC,eAAeA,CAAAC,KAAA,EAAuB;EAAA,IAApBzB,KAAK,GAAAyB,KAAA,CAALzB,KAAK;IAAEC,SAAS,GAAAwB,KAAA,CAATxB,SAAS;EAC9CD,KAAK,CAACE,gBAAgB,CAAC,QAAQ,EAAE,UAACC,KAAK,EAAK;IACxCA,KAAK,CAACC,cAAc,CAAC,CAAC;IACtB,IAAI,CAACD,KAAK,CAACE,MAAM,CAACC,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE;MAC9C;IACJ;IAEA,IAAMzE,OAAO,GAAGkE,KAAK,CAACU,aAAa,CAAC,YAAY,CAAC,CAACC,KAAK,CAACe,IAAI,CAAC,CAAC;IAC9D,IAAMC,KAAK,GAAG3B,KAAK,CAACU,aAAa,CAAC,WAAW,CAAC;IAC9CV,KAAK,CAACU,aAAa,CAAC,YAAY,CAAC,CAACC,KAAK,GAAG,EAAE;IAE5C,IAAMiB,eAAe,GAAG5B,KAAK,CAACU,aAAa,CAAC,iBAAiB,CAAC,CAACJ,SAAS,CAACC,QAAQ,CAAC,SAAS,CAAC;IAC5F,IAAIqB,eAAe,EAAE;MACjBtD,4DAAiB,CAACxC,OAAO,EAAEmE,SAAS,CAACW,cAAc,CAAC,CAC/CC,IAAI,CAAC,UAAAgB,WAAW,EAAI;QACjBxC,iDAAS,CAACwC,WAAW,CAAC;QACtBlC,uDAAgB,CAAC;UAAEgC,KAAK,EAALA,KAAK;UAAE1B,SAAS,EAATA;QAAU,CAAC,CAAC;MAC1C,CAAC,CAAC,SACI,CAAC,UAAAkB,GAAG,EAAI;QACVjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;QACnB5B,gDAAS,CAAC;UAAEQ,KAAK,EAALA,KAAK;UAAEC,SAAS,EAATA;QAAU,CAAC,CAAC;QAC/B,IAAMoB,cAAc,GAAGrB,KAAK,CAACU,aAAa,CAAC,gBAAgB,CAAC;QAC5D,IAAIW,cAAc,EAAE;UAChBA,cAAc,CAACC,KAAK,CAACC,OAAO,GAAG,OAAO;QAC1C;MACJ,CAAC,CAAC;IACV,CAAC,MAAM;MACH,IAAMO,QAAQ,GAAG9B,KAAK,CAACU,aAAa,CAAC,oBAAoB,CAAC;MAC1D,IAAMqB,QAAQ,GAAGD,QAAQ,CAACpB,aAAa,CAAC,gBAAgB,CAAC,CAACsB,WAAW;MACrE,IAAMrE,QAAQ,GAAGC,yDAAc,CAACqC,SAAS,CAACO,QAAQ,EAAEuB,QAAQ,CAAC;MAE7D1D,4DAAiB,CAAC4B,SAAS,CAACO,QAAQ,EAAEuB,QAAQ,EAAEjG,OAAO,EAAEmE,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,CAAC,CACtFkD,IAAI,CAAC,UAAAgB,WAAW,EAAI;QAEjB7C,gDAAQ,CAAC6C,WAAW,EAAElE,QAAQ,CAAC;QAC/B+B,sDAAe,CAAC;UAAEiC,KAAK,EAALA,KAAK;UAAE1B,SAAS,EAATA,SAAS;UAAEtC,QAAQ,EAARA;QAAS,CAAC,CAAC;MACnD,CAAC,CAAC,SACI,CAAC,UAAAwD,GAAG,EAAI;QACVjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;QACnB5B,gDAAS,CAAC;UAAEQ,KAAK,EAALA,KAAK;UAAEC,SAAS,EAATA;QAAU,CAAC,CAAC;QAC/B,IAAMoB,cAAc,GAAGrB,KAAK,CAACU,aAAa,CAAC,gBAAgB,CAAC;QAC5D,IAAIW,cAAc,EAAE;UAChBA,cAAc,CAACC,KAAK,CAACC,OAAO,GAAG,OAAO;QAC1C;MACJ,CAAC,CAAC;IACV;EACJ,CAAC,CAAC;AACN;AAEO,SAASW,iBAAiBA,CAAAC,KAAA,EAAuB;EAAA,IAApBnC,KAAK,GAAAmC,KAAA,CAALnC,KAAK;IAAEC,SAAS,GAAAkC,KAAA,CAATlC,SAAS;EAChDD,KAAK,CAACE,gBAAgB,CAAC,OAAO,EAAE,UAACC,KAAK,EAAK;IACvC,IAAI,CAACA,KAAK,CAACE,MAAM,CAAC+B,OAAO,CAAC,aAAa,CAAC,EAAE;MACtC;IACJ;IAEA3D,sDAAW,CAAC,CAAC,CACRoC,IAAI,CAAC,YAAM;MACRzB,iDAAS,CAAC,CAAC;MACXa,SAAS,CAACmB,KAAK,GAAG,EAAE;MAEpB5B,gDAAS,CAAC;QAAEQ,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;IACnC,CAAC,CAAC,SACI,CAAC,UAACkB,GAAG,EAAK;MACZjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;MACnB5B,gDAAS,CAAC;QAAEQ,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;IACnC,CAAC,CAAC;EACV,CAAC,CAAC;AACN;AAEO,SAASoC,aAAaA,CAAAC,KAAA,EAAuB;EAAA,IAApBtC,KAAK,GAAAsC,KAAA,CAALtC,KAAK;IAAEC,SAAS,GAAAqC,KAAA,CAATrC,SAAS;EAE5CD,KAAK,CAACE,gBAAgB,CAAC,OAAO,EAAE,UAACC,KAAK,EAAK;IACvC,IAAMyB,eAAe,GAAGzB,KAAK,CAACE,MAAM,CAAC+B,OAAO,CAAC,iBAAiB,CAAC;IAC/D,IAAMN,QAAQ,GAAG3B,KAAK,CAACE,MAAM,CAAC+B,OAAO,CAAC,YAAY,CAAC;IACnD,IAAMT,KAAK,GAAG3B,KAAK,CAACU,aAAa,CAAC,WAAW,CAAC;IAE9C,IAAIkB,eAAe,EAAE;MACjBW,UAAU,CAACvC,KAAK,CAAC;MACjB4B,eAAe,CAACtB,SAAS,CAACkC,GAAG,CAAC,SAAS,CAAC;MACxC7C,uDAAgB,CAAC;QAAEgC,KAAK,EAALA,KAAK;QAAE1B,SAAS,EAATA;MAAU,CAAC,CAAC;MACtC;IACJ;IAEA,IAAI6B,QAAQ,EAAE;MACV,IAAMW,eAAe,GAAGX,QAAQ,CAACpB,aAAa,CAAC,gBAAgB,CAAC,CAACsB,WAAW;MAE5EO,UAAU,CAACvC,KAAK,CAAC;MACjB8B,QAAQ,CAACxB,SAAS,CAACkC,GAAG,CAAC,SAAS,CAAC;MACjC,IAAM7E,QAAQ,GAAGC,yDAAc,CAACqC,SAAS,CAACO,QAAQ,EAAEiC,eAAe,CAAC;MACpExC,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,GAAG,CAAC;MAErCY,sDAAW,CAAC0B,SAAS,CAACO,QAAQ,EAAEiC,eAAe,EAAExC,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,CAAC,CAC9EkD,IAAI,CAAC,UAAArE,GAAG,EAAI;QACTyD,SAAS,CAACyC,gBAAgB,CAAC/E,QAAQ,CAAC,GAAG,KAAK;QAC5CqB,gDAAQ,CAACxC,GAAG,EAAEmB,QAAQ,CAAC;QACvBsB,mDAAW,CAACtB,QAAQ,CAAC;QACrB+B,sDAAe,CAAC;UAAEiC,KAAK,EAALA,KAAK;UAAE1B,SAAS,EAATA,SAAS;UAAEtC,QAAQ,EAARA;QAAS,CAAC,CAAC;MACnD,CAAC,CAAC,SAAM,CAAC,UAAAwD,GAAG,EAAI;QACZjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;QACnB5B,gDAAS,CAAC;UAAEQ,KAAK,EAALA,KAAK;UAAEC,SAAS,EAATA;QAAU,CAAC,CAAC;MACnC,CAAC,CAAC;IAEV;EACJ,CAAC,CAAC;AACN;AAEA,SAASsC,UAAUA,CAACvC,KAAK,EAAE;EACvBA,KAAK,CAAC2C,gBAAgB,CAAC,6BAA6B,CAAC,CAACC,OAAO,CAAC,UAAAC,EAAE;IAAA,OAAIA,EAAE,CAACvC,SAAS,CAACwC,MAAM,CAAC,SAAS,CAAC;EAAA,EAAC;AACvG;AAEO,SAAS5B,YAAYA,CAAClB,KAAK,EAAEC,SAAS,EAAE;EAC3C,IAAI,CAACA,SAAS,CAAC8C,UAAU,EAAE;IACvB;EACJ;EACAlD,UAAU,GAAGmD,WAAW,CAAC,YAAM;IAE3B,IAAMC,OAAO,GAAGjD,KAAK,CAACU,aAAa,CAAC,aAAa,CAAC;IAClD,IAAMiB,KAAK,GAAG3B,KAAK,CAACU,aAAa,CAAC,WAAW,CAAC;IAE9C,IAAMwC,eAAe,GAAGlD,KAAK,CAACU,aAAa,CAAC,oBAAoB,CAAC;IACjE,IAAMyC,oBAAoB,GAAGnD,KAAK,CAACU,aAAa,CAAC,yBAAyB,CAAC;IAE3E/B,yDAAc,CAAC,CAAC,CACXkC,IAAI,CAAC,UAAAuC,KAAK,EAAI;MACX7D,oDAAY,CAAC6D,KAAK,CAAC;MACnBxD,sDAAe,CAAC;QAAEqD,OAAO,EAAPA,OAAO;QAAEhD,SAAS,EAATA;MAAU,CAAC,CAAC;MAEvC,IAAIiD,eAAe,EAAE;QACjB,IAAMG,eAAe,GAAGH,eAAe,CAACxC,aAAa,CAAC,gBAAgB,CAAC,CAACsB,WAAW;QACnF,IAAMsB,kBAAkB,GAAGC,KAAK,CAACC,IAAI,CAACP,OAAO,CAACN,gBAAgB,CAAC,YAAY,CAAC,CAAC,CAACc,IAAI,CAAC,UAAAC,IAAI,EAAI;UACvF,OAAOA,IAAI,CAAChD,aAAa,CAAC,gBAAgB,CAAC,CAACsB,WAAW,KAAKqB,eAAe;QAC/E,CAAC,CAAC;QACF,IAAIC,kBAAkB,EAAE;UACpBf,UAAU,CAACvC,KAAK,CAAC;UACjBsD,kBAAkB,CAAChD,SAAS,CAACkC,GAAG,CAAC,SAAS,CAAC;QAC/C;MACJ,CAAC,MAAM,IAAIW,oBAAoB,EAAE;QAC7B,IAAMQ,kBAAkB,GAAG3D,KAAK,CAACU,aAAa,CAAC,iBAAiB,CAAC;QACjE,IAAIiD,kBAAkB,EAAE;UACpBpB,UAAU,CAACvC,KAAK,CAAC;UACjB2D,kBAAkB,CAACrD,SAAS,CAACkC,GAAG,CAAC,SAAS,CAAC;QAC/C;MACJ;IACJ,CAAC,CAAC,SACI,CAAC,UAAArB,GAAG,EAAI;MACVjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;MACnB5B,gDAAS,CAAC;QAAEQ,KAAK,EAALA,KAAK;QAAEC,SAAS,EAATA;MAAU,CAAC,CAAC;IACnC,CAAC,CAAC;IAEN,IAAIiD,eAAe,EAAE;MACjB,IAAMG,eAAe,GAAGH,eAAe,CAACxC,aAAa,CAAC,gBAAgB,CAAC,CAACsB,WAAW;MACnF,IAAMrE,QAAQ,GAAGC,yDAAc,CAACqC,SAAS,CAACO,QAAQ,EAAE6C,eAAe,CAAC;MACpE9E,sDAAW,CAAC0B,SAAS,CAACO,QAAQ,EAAE6C,eAAe,EAAEpD,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,CAAC,CAC9EkD,IAAI,CAAC,UAAAgB,WAAW,EAAI;QACjB7C,gDAAQ,CAAC6C,WAAW,EAAElE,QAAQ,CAAC;QAC/B+B,sDAAe,CAAC;UAAEiC,KAAK,EAALA,KAAK;UAAE1B,SAAS,EAATA,SAAS;UAAEtC,QAAQ,EAARA;QAAS,CAAC,CAAC;MACnD,CAAC,CAAC,SACI,CAAC,UAAAwD,GAAG,EAAI;QACVjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;QACnB5B,gDAAS,CAAC;UAAEQ,KAAK,EAALA,KAAK;UAAEC,SAAS,EAATA;QAAU,CAAC,CAAC;MACnC,CAAC,CAAC;IACV,CAAC,MAAM,IAAIkD,oBAAoB,EAAE;MAC7BzE,0DAAe,CAACuB,SAAS,CAACW,cAAc,CAAC,CACpCC,IAAI,CAAC,UAAAgB,WAAW,EAAI;QACjBxC,iDAAS,CAACwC,WAAW,CAAC;QACtBlC,uDAAgB,CAAC;UAAEgC,KAAK,EAALA,KAAK;UAAE1B,SAAS,EAATA;QAAU,CAAC,CAAC;MAC1C,CAAC,CAAC,SACI,CAAC,UAAAkB,GAAG,EAAI;QACVjC,gDAAQ,CAACiC,GAAG,CAACC,KAAK,CAAC;QACnB5B,gDAAS,CAAC;UAAEQ,KAAK,EAALA,KAAK;UAAEC,SAAS,EAATA;QAAU,CAAC,CAAC;MACnC,CAAC,CAAC;IACV;EACJ,CAAC,EAAE,IAAI,CAAC;AACZ;AAEO,SAAS2D,eAAeA,CAAA,EAAG;EAC9B,IAAI/D,UAAU,EAAE;IACZgE,aAAa,CAAChE,UAAU,CAAC;IACzBA,UAAU,GAAG,IAAI;EACrB;AACJ;;;;;;;;;;;;;;;;;;;;;;AChOO,SAASiE,YAAYA,CAAA,EAAG;EAC3B,IAAMxH,WAAW,GAAG,CAAC;EACrB,OAAOyH,KAAK,gCAAAvG,MAAA,CAAgClB,WAAW,GAAI;IACvD0H,MAAM,EAAE;EACZ,CAAC,CAAC,SAAM,CAAC,UAAA7C,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAE3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAGO,SAAS7F,UAAUA,CAACgC,QAAQ,EAAElE,WAAW,EAAE;EAC9C,OAAOyH,KAAK,CAAC,iBAAiB,EAAE;IAC5BC,MAAM,EAAE,MAAM;IACdM,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEjE,QAAQ,EAARA,QAAQ;MAAElE,WAAW,EAAXA;IAAY,CAAC;EAClD,CAAC,CAAC,SAAM,CAAC,UAAA6E,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAC3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AAEV;AAGO,SAAS5F,WAAWA,CAAA,EAAG;EAC1B,OAAOsF,KAAK,CAAC,iBAAiB,EAAE;IAC5BC,MAAM,EAAE;EACZ,CAAC,CAAC,SAAM,CAAC,UAAA7C,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAC3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAEO,SAAS3F,eAAeA,CAACpC,WAAW,EAAE;EACzC,OAAOyH,KAAK,uCAAAvG,MAAA,CAAuClB,WAAW,GAAI;IAC9D0H,MAAM,EAAE;EACZ,CAAC,CAAC,SAAM,CAAC,UAAA7C,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAC3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAEO,SAAS/F,iBAAiBA,CAACxC,OAAO,EAAEQ,WAAW,EAAE;EAEpD,OAAOyH,KAAK,CAAC,wBAAwB,EAAE;IACnCC,MAAM,EAAE,MAAM;IACdM,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MACjB3I,OAAO,EAAPA,OAAO;MACPQ,WAAW,EAAXA;IACJ,CAAC;EACL,CAAC,CAAC,SAAM,CAAC,UAAA6E,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAE3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAEO,SAAS9F,WAAWA,CAAC3C,MAAM,EAAEmG,QAAQ,EAAEzF,WAAW,EAAE;EAEvD,OAAOyH,KAAK,8BAAAvG,MAAA,CAA8B5B,MAAM,gBAAA4B,MAAA,CAAauE,QAAQ,mBAAAvE,MAAA,CAAgBlB,WAAW,GAAI;IAChG0H,MAAM,EAAE;EAEZ,CAAC,CAAC,SAAM,CAAC,UAAA7C,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAE3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAEO,SAAShG,iBAAiBA,CAACzC,MAAM,EAAEmG,QAAQ,EAAEjG,OAAO,EAAEQ,WAAW,EAAE;EACtE,OAAOyH,KAAK,CAAC,oBAAoB,EAAE;IAC/BC,MAAM,EAAE,MAAM;IACdM,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MACjB7I,MAAM,EAANA,MAAM;MAAEmG,QAAQ,EAARA,QAAQ;MAAEjG,OAAO,EAAPA,OAAO;MAAEQ,WAAW,EAAXA;IAC/B,CAAC;EACL,CAAC,CAAC,SAAM,CAAC,UAAA6E,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAE3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;AAEO,SAAS1F,cAAcA,CAAA,EAAG;EAE7B,OAAOoF,KAAK,CAAC,eAAe,EAAE;IAC1BC,MAAM,EAAE;EACZ,CAAC,CAAC,SAAM,CAAC,UAAA7C,GAAG;IAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC;MAAE9C,KAAK,EAAE;IAAgB,CAAC,CAAC;EAAA,EAAC,CACtDP,IAAI,CAAC,UAAAsD,QAAQ,EAAI;IACd,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MACd,OAAOD,QAAQ,CAACE,IAAI,CAAC,CAAC,CAACxD,IAAI,CAAC,UAAAM,GAAG;QAAA,OAAI8C,OAAO,CAACC,MAAM,CAAC/C,GAAG,CAAC;MAAA,EAAC;IAE3D;IACA,OAAOgD,QAAQ,CAACE,IAAI,CAAC,CAAC;EAC1B,CAAC,CAAC;AACV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5H6C;AAEtC,IAAMpE,SAAS,GAAG;EACrBO,QAAQ,EAAE,EAAE;EACZuC,UAAU,EAAE,KAAK;EACjB2B,YAAY,EAAE,KAAK;EACnBC,WAAW,EAAE,KAAK;EAClBC,oBAAoB,EAAE,KAAK;EAC3BlC,gBAAgB,EAAE;IACd,aAAa,EAAE,KAAK;IACpB,aAAa,EAAE;EACnB,CAAC;EACD9B,cAAc,EAAE,CAAC;EACjBqB,aAAa,EAAE;IACX,aAAa,EAAE,KAAK;IACpB,aAAa,EAAE;EACnB,CAAC;EACD4C,SAAS,EAAE,EAAE;EACbC,qBAAqB,EAAE,EAAE;EACzB9D,iBAAiB,EAAE,EAClB;EACD+D,aAAa,EAAE,CAAC,CAAC;EACjB3D,KAAK,EAAE;AACX,CAAC;AAEM,SAASjC,QAAQA,CAACqB,QAAQ,EAAE;EAC/BP,SAAS,CAACO,QAAQ,GAAGA,QAAQ;EAC7BP,SAAS,CAAC8C,UAAU,GAAG,IAAI;EAC3B9C,SAAS,CAACmB,KAAK,GAAG,EAAE;AACxB;AACO,SAAStC,SAASA,CAAA,EAAG;EACxBmB,SAAS,CAACyE,YAAY,GAAG,IAAI;AACjC;AACO,SAAS3F,eAAeA,CAAA,EAAG;EAC9BkB,SAAS,CAACyE,YAAY,GAAG,KAAK;AAClC;AACO,SAAS9F,QAAQA,CAAA,EAAG;EACvBqB,SAAS,CAAC0E,WAAW,GAAG,IAAI;AAChC;AACO,SAAS9F,cAAcA,CAAA,EAAG;EAC7BoB,SAAS,CAAC0E,WAAW,GAAG,KAAK;AACjC;AACO,SAASvF,SAASA,CAAA,EAAG;EACxBa,SAAS,CAACO,QAAQ,GAAG,EAAE;EACvBP,SAAS,CAAC8C,UAAU,GAAG,KAAK;EAC5B9C,SAAS,CAAC2E,oBAAoB,GAAG,KAAK;EACtChB,0DAAe,CAAC,CAAC;AACrB;AAEO,SAASrE,YAAYA,CAAC6D,KAAK,EAAE;EAChCnD,SAAS,CAAC4E,SAAS,GAAGzB,KAAK;AAC/B;AACO,SAAS9D,YAAYA,CAAA,EAAG;EAC3BW,SAAS,CAAC2E,oBAAoB,GAAG,IAAI;EACrC3E,SAAS,CAACW,cAAc,GAAG1E,IAAI,CAACC,GAAG,CAAC,CAAC;AAEzC;AACO,SAASkD,SAASA,CAAC7C,GAAG,EAAE;EAC3B,IAAIyD,SAAS,CAAC2E,oBAAoB,EAAE;IAAA,IAAAI,qBAAA;IAChC,CAAAA,qBAAA,GAAA/E,SAAS,CAACe,iBAAiB,EAAC5E,IAAI,CAAA6I,KAAA,CAAAD,qBAAA,EAAAE,kBAAA,CAAI1I,GAAG,EAAC;EAE5C,CAAC,MACI;IAAA,IAAA2I,qBAAA;IACD,CAAAA,qBAAA,GAAAlF,SAAS,CAAC6E,qBAAqB,EAAC1I,IAAI,CAAA6I,KAAA,CAAAE,qBAAA,EAAAD,kBAAA,CAAI1I,GAAG,EAAC;EAChD;EACAyD,SAAS,CAACW,cAAc,GAAG1E,IAAI,CAACC,GAAG,CAAC,CAAC;AAEzC;AAEO,SAAS8C,WAAWA,CAACtB,QAAQ,EAAE;EAClCsC,SAAS,CAACyC,gBAAgB,CAAC/E,QAAQ,CAAC,GAAG,IAAI;EAC3CsC,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,GAAGzB,IAAI,CAACC,GAAG,CAAC,CAAC;AAElD;AACO,SAAS6C,QAAQA,CAACxC,GAAG,EAAEmB,QAAQ,EAAE;EACpC,IAAI,CAACsC,SAAS,CAAC8E,aAAa,CAACpH,QAAQ,CAAC,EAAE;IACpCsC,SAAS,CAAC8E,aAAa,CAACpH,QAAQ,CAAC,GAAG,EAAE;EAC1C;EACA,IAAIsC,SAAS,CAACyC,gBAAgB,CAAC/E,QAAQ,CAAC,EAAE;IAAA,IAAAyH,qBAAA;IACtC,CAAAA,qBAAA,GAAAnF,SAAS,CAAC8E,aAAa,CAACpH,QAAQ,CAAC,EAACvB,IAAI,CAAA6I,KAAA,CAAAG,qBAAA,EAAAF,kBAAA,CAAI1I,GAAG,EAAC;EAElD,CAAC,MACI;IACDyD,SAAS,CAAC8E,aAAa,CAACpH,QAAQ,CAAC,GAAGnB,GAAG;EAE3C;EACAyD,SAAS,CAACgC,aAAa,CAACtE,QAAQ,CAAC,GAAGzB,IAAI,CAACC,GAAG,CAAC,CAAC;AAElD;AAEO,SAAS+C,QAAQA,CAACmG,QAAQ,EAAE;EAE/BpF,SAAS,CAACmB,KAAK,GAAGkE,aAAa,CAACD,QAAQ,CAAC,IAAIC,aAAa,CAAC,SAAS,CAAC;EACrE,IAAIrF,SAAS,CAACmB,KAAK,KAAK,eAAe,EAAE;IACrChC,SAAS,CAAC,CAAC;EACf;AAEJ;AACA,IAAMkG,aAAa,GAAG;EAClB,cAAc,EAAE,eAAe;EAC/B,mBAAmB,EAAE,gCAAgC;EACrD,mBAAmB,EAAE,+BAA+B;EACpD,iBAAiB,EAAE,4BAA4B;EAC/C,SAAS,EAAE;AACf,CAAC;;;;;;;;;;;;;;;;;;;ACxGM,SAAS9F,SAASA,CAAAO,IAAA,EAAuB;EAAA,IAApBC,KAAK,GAAAD,IAAA,CAALC,KAAK;IAAEC,SAAS,GAAAF,IAAA,CAATE,SAAS;EACxC,IAAMsF,IAAI,YAAA/H,MAAA,CACRgI,iBAAiB,CAACvF,SAAS,CAAC,WAC7B;EACDD,KAAK,CAACyF,SAAS,GAAGF,IAAI;AAC1B;AACO,SAAS9F,UAAUA,CAAAgC,KAAA,EAAuB;EAAA,IAApBzB,KAAK,GAAAyB,KAAA,CAALzB,KAAK;IAAEC,SAAS,GAAAwB,KAAA,CAATxB,SAAS;EACzC,IAAIA,SAAS,CAAC8C,UAAU,EAAE;IACtB,IAAMwC,IAAI,GAAG,SAAA/H,MAAA,CACfkI,eAAe,CAACzF,SAAS,CAAC,gFAI3B,YAAAzC,MAAA,CACCmI,iBAAiB,CAAC1F,SAAS,CAAC,WAC7B,oFAIA,YAAAzC,MAAA,CACCoI,kBAAkB,CAAC3F,SAAS,CAAC,WAC9B,WAAU,YAAAzC,MAAA,CACTqI,eAAe,CAAC5F,SAAS,CAAC,WAC3B,6BAEM;IACHD,KAAK,CAACyF,SAAS,GAAGF,IAAI;EAC1B;AAEJ;AAEO,SAAS3F,eAAeA,CAAAuC,KAAA,EAAyB;EAAA,IAAtBc,OAAO,GAAAd,KAAA,CAAPc,OAAO;IAAEhD,SAAS,GAAAkC,KAAA,CAATlC,SAAS;EAChD,IAAIA,SAAS,CAAC8C,UAAU,EAAE;IACtB,IAAMwC,IAAI,MAAA/H,MAAA,CAAMmI,iBAAiB,CAAC1F,SAAS,CAAC,CAAE;IAC9CgD,OAAO,CAACwC,SAAS,GAAGF,IAAI;EAC5B;AACJ;AAEO,SAAS5F,gBAAgBA,CAAA2C,KAAA,EAAuB;EAAA,IAApBX,KAAK,GAAAW,KAAA,CAALX,KAAK;IAAE1B,SAAS,GAAAqC,KAAA,CAATrC,SAAS;EAC/C,IAAIA,SAAS,CAAC8C,UAAU,EAAE;IACtB,IAAM+C,cAAc,GAAGnE,KAAK,CAACoE,SAAS;IACtC,IAAMR,IAAI,MAAA/H,MAAA,CAAMoI,kBAAkB,CAAC3F,SAAS,CAAC,CAAE;IAC/C0B,KAAK,CAACoE,SAAS,GAAGD,cAAc;IAChCnE,KAAK,CAAC8D,SAAS,GAAGF,IAAI;EAC1B;AACJ;AAEO,SAAS7F,eAAeA,CAAAsG,KAAA,EAAiC;EAAA,IAA9BrE,KAAK,GAAAqE,KAAA,CAALrE,KAAK;IAAE1B,SAAS,GAAA+F,KAAA,CAAT/F,SAAS;IAAEtC,QAAQ,GAAAqI,KAAA,CAARrI,QAAQ;EACxD,IAAIsC,SAAS,CAAC8C,UAAU,EAAE;IACtB,IAAM7E,QAAQ,GAAG+B,SAAS,CAAC8E,aAAa,CAACpH,QAAQ,CAAC,IAAI,EAAE;IACxD,IAAM4H,IAAI,GAAGrH,QAAQ,CAAC+H,GAAG,CAAC,UAAAC,OAAO;MAAA,mGAAA1I,MAAA,CAEI2I,eAAe,CAACD,OAAO,CAACtK,MAAM,CAAC,gKAAA4B,MAAA,CAGzB0I,OAAO,CAACtK,MAAM,+DAAA4B,MAAA,CAChB0I,OAAO,CAACrK,IAAI,6FAAA2B,MAAA,CAEV0I,OAAO,CAACpK,OAAO;IAAA,CAGzD,CAAC,CAACkC,IAAI,CAAC,EAAE,CAAC;IACX2D,KAAK,CAAC8D,SAAS,GAAGF,IAAI;EAC1B;AACJ;AAEA,SAASC,iBAAiBA,CAACvF,SAAS,EAAE;EAClC,IAAIA,SAAS,CAAC8C,UAAU,EAAE;IACtB,OAAO,EAAE;EACb;EACA,IAAI9C,SAAS,CAACyE,YAAY,EAAE;IACxB;EAKJ;EACA,6RAAAlH,MAAA,CAIuCyC,SAAS,CAACmB,KAAK;AAG1D;AAEA,SAASsE,eAAeA,CAACzF,SAAS,EAAE;EAChC,IAAIA,SAAS,CAAC8C,UAAU,EAAE;IACtB,iFAAAvF,MAAA,CAE2B2I,eAAe,CAAClG,SAAS,CAACO,QAAQ,CAAC;EAUlE;EACA,OAAO,EAAE;AACb;AAEA,SAAS2F,eAAeA,CAACC,IAAI,EAAE;EAC3B,IAAMC,WAAW,GAAGD,IAAI,CAACE,KAAK,CAAC,GAAG,CAAC,CAACL,GAAG,CAAC,UAAAM,IAAI;IAAA,OAAIA,IAAI,CAAC,CAAC,CAAC;EAAA,EAAC,CAACvI,IAAI,CAAC,EAAE,CAAC;EACjE,OAAOqI,WAAW;AACtB;AAEA,SAASV,iBAAiBA,CAAC1F,SAAS,EAAE;EAClC,IAAI,CAACA,SAAS,CAAC8C,UAAU,EAAE;IACvB,OAAO,EAAE;EACb;EACA,IAAMyD,iBAAiB,sIAItB;EAED,IAAMC,SAAS,GAAGxG,SAAS,CAAC4E,SAAS,CAChCtI,MAAM,CAAC,UAAAmK,IAAI;IAAA,OAAIA,IAAI,KAAKzG,SAAS,CAACO,QAAQ;EAAA,EAAC,CAC3CyF,GAAG,CAAC,UAAAS,IAAI;IAAA,qGAAAlJ,MAAA,CAE8B2I,eAAe,CAACO,IAAI,CAAC,2DAAAlJ,MAAA,CACvBkJ,IAAI;EAAA,CAExC,CAAC,CAAC1I,IAAI,CAAC,EAAE,CAAC;EAEf,IAAM2I,aAAa,gBAAAnJ,MAAA,CACbgJ,iBAAiB,gBAAAhJ,MAAA,CACjBiJ,SAAS,WACd;EAED,OAAOE,aAAa;AACxB;AAEA,SAASC,UAAUA,CAAA,EAAG;EAClB;AAKJ;AAEA,SAAShB,kBAAkBA,CAAC3F,SAAS,EAAE;EACnC,IAAI,CAACA,SAAS,CAAC8C,UAAU,EAAE;IACvB,OAAO,EAAE;EACb;EACA,IAAI9C,SAAS,CAAC0E,WAAW,EAAE;IACvB;EAKJ;EACA,IAAMkC,iBAAiB,GAAG5G,SAAS,CAAC6E,qBAAqB,CAACmB,GAAG,CAAC,UAAAC,OAAO;IAAA,mHAAA1I,MAAA,CAEpB2I,eAAe,CAACD,OAAO,CAACtK,MAAM,CAAC,wLAAA4B,MAAA,CAGzB0I,OAAO,CAACtK,MAAM,uEAAA4B,MAAA,CAChB0I,OAAO,CAACrK,IAAI,6GAAA2B,MAAA,CAEV0I,OAAO,CAACpK,OAAO;EAAA,CAGrE,CAAC,CAACkC,IAAI,CAAC,EAAE,CAAC;EAEX,IAAM8I,aAAa,GAAG7G,SAAS,CAACe,iBAAiB,CAACiF,GAAG,CAAC,UAAAC,OAAO;IAAA,mFAAA1I,MAAA,CAE5B2I,eAAe,CAACD,OAAO,CAACtK,MAAM,CAAC,wIAAA4B,MAAA,CAGzB0I,OAAO,CAACtK,MAAM,uDAAA4B,MAAA,CAChB0I,OAAO,CAACrK,IAAI,6EAAA2B,MAAA,CAEV0I,OAAO,CAACpK,OAAO;EAAA,CAGzD,CAAC,CAACkC,IAAI,CAAC,EAAE,CAAC;EAEP,IAAM+I,UAAU,GAAGF,iBAAiB,GAAGD,UAAU,CAAC,CAAC,GAAGE,aAAa;EACnE,OAAOC,UAAU;AAGrB;AAEA,SAASlB,eAAeA,CAAC5F,SAAS,EAAE;EAChC,IAAI,CAACA,SAAS,CAAC8C,UAAU,EAAE;IACvB,OAAO,EAAE;EACb;EACA;AAcJ;;;;;;UC7MA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;ACN+C;AAC4E;AACZ;AACrE;AAG1C,IAAM/C,KAAK,GAAGS,QAAQ,CAACC,aAAa,CAAC,SAAS,CAAC;AAC/CjB,iDAAU,CAAC;EAAEO,KAAK,EAALA,KAAK;EAAEC,SAAS,EAATA,6CAASA;AAAC,CAAC,CAAC;AAChCH,2DAAgB,CAAC;EAAEE,KAAK,EAALA,KAAK;EAAEC,SAAS,EAATA,6CAASA;AAAC,CAAC,CAAC;AACtCoC,wDAAa,CAAC;EAAErC,KAAK,EAALA,KAAK;EAAEC,SAAS,EAATA,6CAASA;AAAC,CAAC,CAAC;AACnCuB,0DAAe,CAAC;EAAExB,KAAK,EAALA,KAAK;EAAEC,SAAS,EAATA,6CAASA;AAAC,CAAC,CAAC;AACrCiC,4DAAiB,CAAC;EAAElC,KAAK,EAALA,KAAK;EAAEC,SAAS,EAATA,6CAASA;AAAC,CAAC,CAAC;AAEvC6D,uDAAY,CAAC,CAAC,CACTjD,IAAI,CAAC,UAACC,IAAI,EAAK;EACZhC,iDAAS,CAAC,CAAC;EACXU,gDAAS,CAAC;IAAEQ,KAAK,EAALA,KAAK;IAAEC,SAAS,EAATA,6CAASA;EAAC,CAAC,CAAC;EAC/BV,oDAAY,CAACuB,IAAI,CAACC,QAAQ,CAAC;EAC3B1B,iDAAS,CAACyB,IAAI,CAACE,iBAAiB,CAAC;EACjC7B,gDAAQ,CAAC2B,IAAI,CAACN,QAAQ,CAAC;EACvBlB,oDAAY,CAAC,CAAC;EACdP,uDAAe,CAAC,CAAC;EACjBU,iDAAU,CAAC;IAAEO,KAAK,EAALA,KAAK;IAAEC,SAAS,EAATA,6CAASA;EAAC,CAAC,CAAC;EAEhC,IAAIA,6CAAS,CAAC8C,UAAU,EAAE;IACtB7B,uDAAY,CAAClB,KAAK,EAAEC,6CAAS,CAAC;EAClC;AACJ,CAAC,CAAC,SACI,CAAC,YAAM;EACTb,iDAAS,CAAC,CAAC;EAGXI,gDAAS,CAAC;IAAEQ,KAAK,EAALA,KAAK;IAAEC,SAAS,EAATA,6CAASA;EAAC,CAAC,CAAC;EAE/B,IAAMoB,cAAc,GAAGrB,KAAK,CAACU,aAAa,CAAC,gBAAgB,CAAC;EAC5D,IAAIW,cAAc,EAAE;IAChBA,cAAc,CAACC,KAAK,CAACC,OAAO,GAAG,OAAO;EAC1C;AACJ,CAAC,CAAC,C","sources":["webpack://project2/./messages.js","webpack://project2/./src/listener.js","webpack://project2/./src/services.js","webpack://project2/./src/state.js","webpack://project2/./src/view.js","webpack://project2/webpack/bootstrap","webpack://project2/webpack/runtime/compat get default export","webpack://project2/webpack/runtime/define property getters","webpack://project2/webpack/runtime/hasOwnProperty shorthand","webpack://project2/webpack/runtime/make namespace object","webpack://project2/./src/chat.js"],"sourcesContent":["const publicMessages = [\r\n    {\r\n        sender: \"Harry\",\r\n        time: \"2024-11-08 10:00:25\",\r\n        content: \"Good mornming!\",\r\n        timestamp: 1721298470071\r\n    },\r\n    {\r\n        sender: \"Draco\",\r\n        time: \"2024-11-08 10:02:10\",\r\n        content: \"You too.\",\r\n        timestamp: 1721298470072\r\n    },\r\n    {\r\n        sender: \"Yiwen\",\r\n        time: \"2024-11-08 10:10:35\",\r\n        content: \"Bad news: Yesterday was Thursday bu I forgot to buy F4.\",\r\n        timestamp: 1721298470073\r\n    },\r\n    {\r\n        sender: \"Draco\",\r\n        time: \"2024-11-09 10:15:35\",\r\n        content: \"It's a cold day.\",\r\n        timestamp: 1731301057638\r\n    }\r\n];\r\n\r\nfunction addPublicMessage(sender, content) {\r\n    const time = getTime();\r\n    const timestamp = Date.now();\r\n    publicMessages.push({ sender, time, content, timestamp });\r\n}\r\n\r\nfunction getNewPublicMessages(lastUpdated) {\r\n    return publicMessages.filter(msg => msg.timestamp >= lastUpdated);\r\n}\r\n\r\nfunction getTime() {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    const hours = String(date.getHours()).padStart(2, '0');\r\n    const minutes = String(date.getMinutes()).padStart(2, '0');\r\n    const seconds = String(date.getSeconds()).padStart(2, '0');\r\n\r\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\r\n\r\n}\r\n\r\nconst dmMessages = {\r\n    \"Draco_Harry\": [\r\n        {\r\n            sender: \"Harry\",\r\n            time: \"2024-11-08 11:24:25\",\r\n            content: \"Have you finished project2?\",\r\n            timestamp: 1\r\n        },\r\n        {\r\n            sender: \"Draco\",\r\n            time: \"2024-11-08 11:25:25\",\r\n            content: \"Not yet.\",\r\n            timestamp: 2\r\n        },\r\n    ],\r\n    \"Harry_Yiwen\": [\r\n        {\r\n            sender: \"Harry\",\r\n            time: \"2024-11-08 13:46:10\",\r\n            content: \"Would you like to have some mochinuts?\",\r\n            timestamp: 1\r\n        },\r\n        {\r\n            sender: \"Yiwen\",\r\n            time: \"2024-11-08 13:49:16\",\r\n            content: \"Why not? Iâ€™m just about to head out.\",\r\n            timestamp: 2\r\n        },\r\n        {\r\n            sender: \"Harry\",\r\n            time: \"2024-11-08 13:50:16\",\r\n            content: \"See you in the lobby.\",\r\n            timestamp: 3\r\n        },\r\n    ]\r\n}\r\n\r\nfunction addDmMessage(chatPair, sender, content) {\r\n    if (!dmMessages[chatPair]) {\r\n        dmMessages[chatPair] = [];\r\n    }\r\n    const timestamp = Date.now();\r\n    const time = getTime();\r\n    dmMessages[chatPair].push({ sender, time, content, timestamp });\r\n}\r\n\r\nfunction createChatPair(user1, user2) {\r\n    const chatPair = [user1, user2].sort().join(\"_\");\r\n    return chatPair\r\n}\r\n\r\nfunction getNewDmMessages(chatPair, lastUpdated) {\r\n    if (!dmMessages[chatPair]) {\r\n        return [];\r\n    }\r\n    return dmMessages[chatPair].filter(msg => msg.timestamp > lastUpdated);\r\n}\r\n\r\nconst messages = {\r\n    publicMessages,\r\n    addPublicMessage,\r\n    getNewPublicMessages,\r\n    dmMessages,\r\n    addDmMessage,\r\n    createChatPair,\r\n    getNewDmMessages\r\n}\r\n\r\nmodule.exports = messages;","import { createChatPair } from \"../messages\";\r\nimport { fetchAddDmMessage, fetchAddPublicMsg, fetchDmList, fetchLogin, fetchLogout, fetchPublicList, fetchUsersList } from \"./services\";\r\nimport { loadChat, loadChatFinish, loadLogin, loadLoginFinish, setDmMsg, setDmUpdate, setError, setLogin, setLogout, setPubMsg, setPubUpdate, setUsersList } from \"./state\";\r\nimport { renderApp, renderChat, renderDmMsgList, renderPubMsgList, renderUsersList } from \"./view\";\r\nlet intervalId = null;\r\n\r\nexport function addLoginListener({ appEl, userState }) {\r\n    appEl.addEventListener('submit', (event) => {\r\n        event.preventDefault();\r\n        if (!event.target.classList.contains(\"login-form\")) {\r\n            return;\r\n        }\r\n        const username = document.querySelector('.enter-username').value;\r\n        loadLogin();\r\n        renderApp({ appEl, userState });\r\n        fetchLogin(username, userState.pubLastUpdated)\r\n            .then(info => {\r\n                loadChat();\r\n                loadLoginFinish();\r\n                setUsersList(info.userList);\r\n                setPubMsg(info.newPublicMessages);\r\n                setLogin(username);\r\n                setPubUpdate();\r\n                renderChat({ appEl, userState });\r\n                return fetchPublicList(userState.pubLastUpdated);\r\n            }).then(newMsg => {\r\n                setPubMsg(newMsg);\r\n                loadChatFinish();\r\n                renderChat({ appEl, userState });\r\n                startPolling(appEl, userState);\r\n            })\r\n            .catch((err) => {\r\n                setError(err.error);\r\n                loadLoginFinish();\r\n                renderApp({ appEl, userState });\r\n                const errorMessageEl = appEl.querySelector('.error-message');\r\n                if (errorMessageEl) {\r\n                    errorMessageEl.style.display = 'block';\r\n                }\r\n            })\r\n    })\r\n\r\n}\r\n\r\nexport function addSendListener({ appEl, userState }) {\r\n    appEl.addEventListener('submit', (event) => {\r\n        event.preventDefault();\r\n        if (!event.target.classList.contains(\"send-box\")) {\r\n            return;\r\n        }\r\n\r\n        const content = appEl.querySelector('.enter-msg').value.trim();\r\n        const msgEl = appEl.querySelector(\".msg-list\");\r\n        appEl.querySelector('.enter-msg').value = '';\r\n\r\n        const isPublicChannel = appEl.querySelector('.public-channel').classList.contains('focused');\r\n        if (isPublicChannel) {\r\n            fetchAddPublicMsg(content, userState.pubLastUpdated)\r\n                .then(newMessages => {\r\n                    setPubMsg(newMessages);\r\n                    renderPubMsgList({ msgEl, userState });\r\n                })\r\n                .catch(err => {\r\n                    setError(err.error);\r\n                    renderApp({ appEl, userState });\r\n                    const errorMessageEl = appEl.querySelector('.error-message');\r\n                    if (errorMessageEl) {\r\n                        errorMessageEl.style.display = 'block';\r\n                    }\r\n                });\r\n        } else {\r\n            const chatUnit = appEl.querySelector('.chat-unit.focused');\r\n            const receiver = chatUnit.querySelector('.receiver-name').textContent;\r\n            const chatPair = createChatPair(userState.username, receiver);\r\n\r\n            fetchAddDmMessage(userState.username, receiver, content, userState.dmLastUpdated[chatPair])\r\n                .then(newMessages => {\r\n\r\n                    setDmMsg(newMessages, chatPair);\r\n                    renderDmMsgList({ msgEl, userState, chatPair });\r\n                })\r\n                .catch(err => {\r\n                    setError(err.error);\r\n                    renderApp({ appEl, userState });\r\n                    const errorMessageEl = appEl.querySelector('.error-message');\r\n                    if (errorMessageEl) {\r\n                        errorMessageEl.style.display = 'block';\r\n                    }\r\n                });\r\n        }\r\n    });\r\n}\r\n\r\nexport function addLogoutListener({ appEl, userState }) {\r\n    appEl.addEventListener('click', (event) => {\r\n        if (!event.target.closest('.logout-btn')) {\r\n            return;\r\n        }\r\n\r\n        fetchLogout()\r\n            .then(() => {\r\n                setLogout();\r\n                userState.error = \"\";\r\n\r\n                renderApp({ appEl, userState });\r\n            })\r\n            .catch((err) => {\r\n                setError(err.error);\r\n                renderApp({ appEl, userState });\r\n            });\r\n    });\r\n}\r\n\r\nexport function addDmListener({ appEl, userState }) {\r\n\r\n    appEl.addEventListener('click', (event) => {\r\n        const isPublicChannel = event.target.closest('.public-channel');\r\n        const chatUnit = event.target.closest('.chat-unit');\r\n        const msgEl = appEl.querySelector('.msg-list');\r\n\r\n        if (isPublicChannel) {\r\n            clearFocus(appEl);\r\n            isPublicChannel.classList.add('focused');\r\n            renderPubMsgList({ msgEl, userState })\r\n            return;\r\n        }\r\n\r\n        if (chatUnit) {\r\n            const clickedUsername = chatUnit.querySelector('.receiver-name').textContent;\r\n\r\n            clearFocus(appEl);\r\n            chatUnit.classList.add('focused');\r\n            const chatPair = createChatPair(userState.username, clickedUsername);\r\n            userState.dmLastUpdated[chatPair] = 0;\r\n\r\n            fetchDmList(userState.username, clickedUsername, userState.dmLastUpdated[chatPair])\r\n                .then(msg => {\r\n                    userState.updateDmMessages[chatPair] = false;\r\n                    setDmMsg(msg, chatPair)\r\n                    setDmUpdate(chatPair);\r\n                    renderDmMsgList({ msgEl, userState, chatPair });\r\n                }).catch(err => {\r\n                    setError(err.error);\r\n                    renderApp({ appEl, userState });\r\n                });\r\n\r\n        }\r\n    })\r\n}\r\n\r\nfunction clearFocus(appEl) {\r\n    appEl.querySelectorAll('.public-channel, .chat-unit').forEach(el => el.classList.remove('focused'));\r\n}\r\n\r\nexport function startPolling(appEl, userState) {\r\n    if (!userState.loginState) {\r\n        return;\r\n    }\r\n    intervalId = setInterval(() => {\r\n\r\n        const usersEl = appEl.querySelector(\".users-list\");\r\n        const msgEl = appEl.querySelector(\".msg-list\");\r\n\r\n        const focusedChatUnit = appEl.querySelector(\".chat-unit.focused\");\r\n        const focusedPublicChannel = appEl.querySelector(\".public-channel.focused\");\r\n\r\n        fetchUsersList()\r\n            .then(users => {\r\n                setUsersList(users);\r\n                renderUsersList({ usersEl, userState });\r\n\r\n                if (focusedChatUnit) {\r\n                    const focusedUsername = focusedChatUnit.querySelector(\".receiver-name\").textContent;\r\n                    const newFocusedChatUnit = Array.from(usersEl.querySelectorAll(\".chat-unit\")).find(unit => {\r\n                        return unit.querySelector(\".receiver-name\").textContent === focusedUsername;\r\n                    });\r\n                    if (newFocusedChatUnit) {\r\n                        clearFocus(appEl);\r\n                        newFocusedChatUnit.classList.add(\"focused\");\r\n                    }\r\n                } else if (focusedPublicChannel) {\r\n                    const newPublicChannelEl = appEl.querySelector(\".public-channel\");\r\n                    if (newPublicChannelEl) {\r\n                        clearFocus(appEl);\r\n                        newPublicChannelEl.classList.add(\"focused\");\r\n                    }\r\n                }\r\n            })\r\n            .catch(err => {\r\n                setError(err.error);\r\n                renderApp({ appEl, userState });\r\n            });\r\n\r\n        if (focusedChatUnit) {\r\n            const focusedUsername = focusedChatUnit.querySelector(\".receiver-name\").textContent;\r\n            const chatPair = createChatPair(userState.username, focusedUsername);\r\n            fetchDmList(userState.username, focusedUsername, userState.dmLastUpdated[chatPair])\r\n                .then(newMessages => {\r\n                    setDmMsg(newMessages, chatPair);\r\n                    renderDmMsgList({ msgEl, userState, chatPair });\r\n                })\r\n                .catch(err => {\r\n                    setError(err.error);\r\n                    renderApp({ appEl, userState });\r\n                });\r\n        } else if (focusedPublicChannel) {\r\n            fetchPublicList(userState.pubLastUpdated)\r\n                .then(newMessages => {\r\n                    setPubMsg(newMessages);\r\n                    renderPubMsgList({ msgEl, userState });\r\n                })\r\n                .catch(err => {\r\n                    setError(err.error);\r\n                    renderApp({ appEl, userState });\r\n                });\r\n        }\r\n    }, 5000);\r\n}\r\n\r\nexport function clearIntervalId() {\r\n    if (intervalId) {\r\n        clearInterval(intervalId);\r\n        intervalId = null;\r\n    }\r\n}","export function fetchSession() {\r\n    const lastUpdated = 0;\r\n    return fetch(`/api/v1/session?lastUpdated=${lastUpdated}`, {\r\n        method: 'GET'\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err));\r\n\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\n\r\nexport function fetchLogin(username, lastUpdated) {\r\n    return fetch('/api/v1/session', {\r\n        method: 'POST',\r\n        headers: {\r\n            'content-type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ username, lastUpdated })\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err));\r\n            }\r\n            return response.json();\r\n        })\r\n\r\n}\r\n\r\n\r\nexport function fetchLogout() {\r\n    return fetch('/api/v1/session', {\r\n        method: 'DELETE'\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\nexport function fetchPublicList(lastUpdated) {\r\n    return fetch(`/api/v1/publicMessages?lastUpdated=${lastUpdated}`, {\r\n        method: 'GET'\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\nexport function fetchAddPublicMsg(content, lastUpdated) {\r\n\r\n    return fetch('/api/v1/publicMessages', {\r\n        method: 'POST',\r\n        headers: {\r\n            'content-type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n            content,\r\n            lastUpdated\r\n        })\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\nexport function fetchDmList(sender, receiver, lastUpdated) {\r\n\r\n    return fetch(`/api/v1/dmMessages?sender=${sender}&receiver=${receiver}&lastUpdated=${lastUpdated}`, {\r\n        method: 'GET',\r\n\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\nexport function fetchAddDmMessage(sender, receiver, content, lastUpdated) {\r\n    return fetch('/api/v1/dmMessages', {\r\n        method: 'POST',\r\n        headers: {\r\n            'content-type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n            sender, receiver, content, lastUpdated\r\n        })\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n\r\n            }\r\n            return response.json();\r\n        })\r\n}\r\n\r\nexport function fetchUsersList() {\r\n\r\n    return fetch('/api/v1/users', {\r\n        method: 'GET',\r\n    }).catch(err => Promise.reject({ error: 'network-error' }))\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                return response.json().then(err => Promise.reject(err))\r\n\r\n            }\r\n            return response.json();\r\n        })\r\n}","import { clearIntervalId } from \"./listener\";\r\n\r\nexport const userState = {\r\n    username: \"\",\r\n    loginState: false,\r\n    loginPending: false,\r\n    chatPending: false,\r\n    updatePublicMessages: false,\r\n    updateDmMessages: {\r\n        \"Draco_Harry\": false,\r\n        \"Harry_Yiwen\": false,\r\n    },\r\n    pubLastUpdated: 0,\r\n    dmLastUpdated: {\r\n        \"Draco_Harry\": false,\r\n        \"Harry_Yiwen\": false,\r\n    },\r\n    usersList: [],\r\n    historyPublicMessages: [],\r\n    newPublicMessages: [\r\n    ],\r\n    newDmMessages: {},\r\n    error: \"\"\r\n};\r\n\r\nexport function setLogin(username) {\r\n    userState.username = username;\r\n    userState.loginState = true;\r\n    userState.error = \"\";\r\n}\r\nexport function loadLogin() {\r\n    userState.loginPending = true;\r\n}\r\nexport function loadLoginFinish() {\r\n    userState.loginPending = false;\r\n}\r\nexport function loadChat() {\r\n    userState.chatPending = true;\r\n}\r\nexport function loadChatFinish() {\r\n    userState.chatPending = false;\r\n}\r\nexport function setLogout() {\r\n    userState.username = \"\";\r\n    userState.loginState = false;\r\n    userState.updatePublicMessages = false;\r\n    clearIntervalId();\r\n}\r\n\r\nexport function setUsersList(users) {\r\n    userState.usersList = users;\r\n}\r\nexport function setPubUpdate() {\r\n    userState.updatePublicMessages = true;\r\n    userState.pubLastUpdated = Date.now();\r\n\r\n}\r\nexport function setPubMsg(msg) {\r\n    if (userState.updatePublicMessages) {\r\n        userState.newPublicMessages.push(...msg);\r\n\r\n    }\r\n    else {\r\n        userState.historyPublicMessages.push(...msg);\r\n    }\r\n    userState.pubLastUpdated = Date.now();\r\n\r\n}\r\n\r\nexport function setDmUpdate(chatPair) {\r\n    userState.updateDmMessages[chatPair] = true;\r\n    userState.dmLastUpdated[chatPair] = Date.now();\r\n\r\n}\r\nexport function setDmMsg(msg, chatPair) {\r\n    if (!userState.newDmMessages[chatPair]) {\r\n        userState.newDmMessages[chatPair] = [];\r\n    }\r\n    if (userState.updateDmMessages[chatPair]) {\r\n        userState.newDmMessages[chatPair].push(...msg);\r\n\r\n    }\r\n    else {\r\n        userState.newDmMessages[chatPair] = msg;\r\n\r\n    }\r\n    userState.dmLastUpdated[chatPair] = Date.now();\r\n\r\n}\r\n\r\nexport function setError(errorMsg) {\r\n\r\n    userState.error = errorMessages[errorMsg] || errorMessages['default'];\r\n    if (userState.error === 'Please login.') {\r\n        setLogout();\r\n    }\r\n\r\n}\r\nconst errorMessages = {\r\n    'auth-missing': 'Please login.',\r\n    'required-username': 'Please enter correct username.',\r\n    'auth-insufficient': 'This username is not allowed.',\r\n    'content-missing': 'Please enter your message.',\r\n    'default': 'Please login.'\r\n}\r\n","export function renderApp({ appEl, userState }) {\r\n    const html = `\r\n    ${generateLoginHtml(userState)}\r\n    `;\r\n    appEl.innerHTML = html;\r\n}\r\nexport function renderChat({ appEl, userState }) {\r\n    if (userState.loginState) {\r\n        const html = `\r\n    ${generateUserBar(userState)}\r\n    ` + `\r\n    <div class=\"main\">\r\n    <div class=\"users-list\">\r\n    ` + `\r\n    ${generateUsersList(userState)}\r\n    ` + `\r\n    </div>\r\n    <div class=\"msg-board\">\r\n    <div class=\"msg-list\">\r\n    ` + `\r\n    ${generatePubMsgList(userState)}\r\n    `+ `</div>` + `\r\n    ${generateSendBox(userState)}\r\n    `+ `\r\n    </div>\r\n    </div>`;\r\n        appEl.innerHTML = html;\r\n    }\r\n\r\n}\r\n\r\nexport function renderUsersList({ usersEl, userState }) {\r\n    if (userState.loginState) {\r\n        const html = `${generateUsersList(userState)}`;\r\n        usersEl.innerHTML = html;\r\n    }\r\n}\r\n\r\nexport function renderPubMsgList({ msgEl, userState }) {\r\n    if (userState.loginState) {\r\n        const scrollPosition = msgEl.scrollTop;\r\n        const html = `${generatePubMsgList(userState)}`;\r\n        msgEl.scrollTop = scrollPosition;\r\n        msgEl.innerHTML = html;\r\n    }\r\n}\r\n\r\nexport function renderDmMsgList({ msgEl, userState, chatPair }) {\r\n    if (userState.loginState) {\r\n        const messages = userState.newDmMessages[chatPair] || [];\r\n        const html = messages.map(message => `\r\n            <div class=\"message-unit\">\r\n                <div class=\"sender-avatar\">${takeFirstLetter(message.sender)}</div>\r\n                <div class=\"message-body\">\r\n                    <div class=\"sender-info\">\r\n                        <div class=\"sender-name\">${message.sender}</div>\r\n                        <div class=\"send-time\">${message.time}</div>\r\n                    </div>\r\n                    <div class=\"message-content\">${message.content}</div>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n        msgEl.innerHTML = html;\r\n    }\r\n}\r\n\r\nfunction generateLoginHtml(userState) {\r\n    if (userState.loginState) {\r\n        return '';\r\n    }\r\n    if (userState.loginPending) {\r\n        return `\r\n        <div class=\"load-login\">\r\n            <p>Logging in......</p>\r\n        </div>        \r\n        `;\r\n    }\r\n    return `\r\n        <form class=\"login-form\">\r\n            <input type=\"text\" class=\"enter-username\" name=\"username\" placeholder=\"Please enter your username\">\r\n            <button type=\"submit\" class=\"login-btn\">Login</button>\r\n            <small class=\"error-message\">${userState.error}</small>\r\n        </form>\r\n    `;\r\n}\r\n\r\nfunction generateUserBar(userState) {\r\n    if (userState.loginState) {\r\n        return `\r\n        <div class=\"user-bar\">\r\n        <div class=\"user-avatar\">${takeFirstLetter(userState.username)}</div>\r\n        <button class=\"logout-btn\" title=\"Log out\">\r\n            <svg width=\"50px\" height=\"50px\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                <path opacity=\"0.5\" d=\"M12 20C7.58172 20 4 16.4183 4 12C4 7.58172 7.58172 4 12 4\" stroke=\"#ffffff\"\r\n                    stroke-width=\"1.5\" stroke-linecap=\"round\" />\r\n                <path d=\"M10 12H20M20 12L17 9M20 12L17 15\" stroke=\"#ffffff\" stroke-width=\"1.5\"\r\n                    stroke-linecap=\"round\" stroke-linejoin=\"round\" />\r\n            </svg>\r\n        </button>\r\n        </div>`;\r\n    }\r\n    return '';\r\n}\r\n\r\nfunction takeFirstLetter(name) {\r\n    const firstLetter = name.split(' ').map(word => word[0]).join('');\r\n    return firstLetter;\r\n}\r\n\r\nfunction generateUsersList(userState) {\r\n    if (!userState.loginState) {\r\n        return '';\r\n    }\r\n    const publicChannelHtml = `\r\n    <button class=\"public-channel focused\">\r\n        <div class=\"receiver-name\"># Public channel</div>\r\n    </button>\r\n    `;\r\n\r\n    const usersHtml = userState.usersList\r\n        .filter(user => user !== userState.username)\r\n        .map(user => `\r\n            <button class=\"chat-unit\">\r\n                <div class=\"receiver-avatar\">${takeFirstLetter(user)}</div>\r\n                <div class=\"receiver-name\">${user}</div>\r\n            </button>    \r\n        `).join('');\r\n\r\n    const usersListHtml = `\r\n        ${publicChannelHtml}\r\n        ${usersHtml}\r\n    `;\r\n\r\n    return usersListHtml;\r\n}\r\n\r\nfunction getDivider() {\r\n    return `\r\n    <div class=\"divider\">\r\n        <span>History messages</span>\r\n    </div>\r\n    `;\r\n}\r\n\r\nfunction generatePubMsgList(userState) {\r\n    if (!userState.loginState) {\r\n        return '';\r\n    }\r\n    if (userState.chatPending) {\r\n        return `\r\n        <div class=\"load-chat\">\r\n            <p>Loading......</p>\r\n        </div>\r\n        `\r\n    }\r\n    const historyPubMsgList = userState.historyPublicMessages.map(message => `\r\n                    <div class=\"message-unit\">\r\n                        <div class=\"sender-avatar\">${takeFirstLetter(message.sender)}</div>\r\n                        <div class=\"message-body\">\r\n                            <div class=\"sender-info\">\r\n                                <div class=\"sender-name\">${message.sender}</div>\r\n                                <div class=\"send-time\">${message.time}</div>\r\n                            </div>\r\n                            <div class=\"message-content\">${message.content}</div>\r\n                        </div>\r\n                    </div>\r\n    `).join('');\r\n\r\n    const newPubMsgList = userState.newPublicMessages.map(message => `\r\n    <div class=\"message-unit\">\r\n        <div class=\"sender-avatar\">${takeFirstLetter(message.sender)}</div>\r\n        <div class=\"message-body\">\r\n            <div class=\"sender-info\">\r\n                <div class=\"sender-name\">${message.sender}</div>\r\n                <div class=\"send-time\">${message.time}</div>\r\n            </div>\r\n            <div class=\"message-content\">${message.content}</div>\r\n        </div>\r\n    </div>\r\n`).join('');\r\n\r\n    const pubMsgList = historyPubMsgList + getDivider() + newPubMsgList;\r\n    return pubMsgList;\r\n\r\n\r\n}\r\n\r\nfunction generateSendBox(userState) {\r\n    if (!userState.loginState) {\r\n        return '';\r\n    }\r\n    return `\r\n    <form class=\"send-box\">\r\n                    <input type=\"text\" class=\"enter-msg\" name=\"content\" placeholder=\"Please enter your message.\"\r\n                        required>\r\n                    <button class=\"send-msg\">\r\n\r\n                        <svg width=\"45px\" height=\"45px\" viewBox=\"0 0 24 24\" fill=\"none\"\r\n                            xmlns=\"http://www.w3.org/2000/svg\">\r\n                            <path\r\n                                d=\"M16.1391 2.95907L7.10914 5.95907C1.03914 7.98907 1.03914 11.2991 7.10914 13.3191L9.78914 14.2091L10.6791 16.8891C12.6991 22.9591 16.0191 22.9591 18.0391 16.8891L21.0491 7.86907C22.3891 3.81907 20.1891 1.60907 16.1391 2.95907ZM16.4591 8.33907L12.6591 12.1591C12.5091 12.3091 12.3191 12.3791 12.1291 12.3791C11.9391 12.3791 11.7491 12.3091 11.5991 12.1591C11.3091 11.8691 11.3091 11.3891 11.5991 11.0991L15.3991 7.27907C15.6891 6.98907 16.1691 6.98907 16.4591 7.27907C16.7491 7.56907 16.7491 8.04907 16.4591 8.33907Z\" />\r\n                        </svg>\r\n                    </button>\r\n                </form>\r\n    `;\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { renderApp, renderChat } from \"./view\";\r\nimport { loadLogin, loadLoginFinish, setLogin, setLogout, setPubMsg, setPubUpdate, setUsersList, userState } from \"./state\"\r\nimport { addDmListener, addLoginListener, addLogoutListener, addSendListener, startPolling } from \"./listener\";\r\nimport { fetchSession } from \"./services\";\r\n\r\n\r\nconst appEl = document.querySelector(\".bottom\");\r\nrenderChat({ appEl, userState });\r\naddLoginListener({ appEl, userState });\r\naddDmListener({ appEl, userState });\r\naddSendListener({ appEl, userState });\r\naddLogoutListener({ appEl, userState });\r\n\r\nfetchSession()\r\n    .then((info) => {\r\n        loadLogin();\r\n        renderApp({ appEl, userState });\r\n        setUsersList(info.userList);\r\n        setPubMsg(info.newPublicMessages);\r\n        setLogin(info.username);\r\n        setPubUpdate();\r\n        loadLoginFinish();\r\n        renderChat({ appEl, userState });\r\n\r\n        if (userState.loginState) {\r\n            startPolling(appEl, userState);\r\n        }\r\n    })\r\n    .catch(() => {\r\n        setLogout();\r\n\r\n\r\n        renderApp({ appEl, userState });\r\n\r\n        const errorMessageEl = appEl.querySelector('.error-message');\r\n        if (errorMessageEl) {\r\n            errorMessageEl.style.display = 'block';\r\n        }\r\n    });\r\n"],"names":["publicMessages","sender","time","content","timestamp","addPublicMessage","getTime","Date","now","push","getNewPublicMessages","lastUpdated","filter","msg","date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","concat","dmMessages","addDmMessage","chatPair","createChatPair","user1","user2","sort","join","getNewDmMessages","messages","module","exports","fetchAddDmMessage","fetchAddPublicMsg","fetchDmList","fetchLogin","fetchLogout","fetchPublicList","fetchUsersList","loadChat","loadChatFinish","loadLogin","loadLoginFinish","setDmMsg","setDmUpdate","setError","setLogin","setLogout","setPubMsg","setPubUpdate","setUsersList","renderApp","renderChat","renderDmMsgList","renderPubMsgList","renderUsersList","intervalId","addLoginListener","_ref","appEl","userState","addEventListener","event","preventDefault","target","classList","contains","username","document","querySelector","value","pubLastUpdated","then","info","userList","newPublicMessages","newMsg","startPolling","err","error","errorMessageEl","style","display","addSendListener","_ref2","trim","msgEl","isPublicChannel","newMessages","chatUnit","receiver","textContent","dmLastUpdated","addLogoutListener","_ref3","closest","addDmListener","_ref4","clearFocus","add","clickedUsername","updateDmMessages","querySelectorAll","forEach","el","remove","loginState","setInterval","usersEl","focusedChatUnit","focusedPublicChannel","users","focusedUsername","newFocusedChatUnit","Array","from","find","unit","newPublicChannelEl","clearIntervalId","clearInterval","fetchSession","fetch","method","Promise","reject","response","ok","json","headers","body","JSON","stringify","loginPending","chatPending","updatePublicMessages","usersList","historyPublicMessages","newDmMessages","_userState$newPublicM","apply","_toConsumableArray","_userState$historyPub","_userState$newDmMessa","errorMsg","errorMessages","html","generateLoginHtml","innerHTML","generateUserBar","generateUsersList","generatePubMsgList","generateSendBox","scrollPosition","scrollTop","_ref5","map","message","takeFirstLetter","name","firstLetter","split","word","publicChannelHtml","usersHtml","user","usersListHtml","getDivider","historyPubMsgList","newPubMsgList","pubMsgList"],"sourceRoot":""}